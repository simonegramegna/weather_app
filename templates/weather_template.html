<!DOCTYPE html>
<html>
    <head>

      <title> GetWeatherToday.herokuapp.com </title>
      <meta charset="UTF-8"> 
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <!--main font-->
      <link href="https://fonts.googleapis.com/css?family=Manjari&display=swap" rel="stylesheet">
      
      <!--jquery-->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <!--font awesome-->
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.2/css/all.css" integrity="sha384-rtJEYb85SiYWgfpCr0jn174XgJTn4rptSOQsMroFBPQSGLdOC5IbubP6lJ35qoM9" crossorigin="anonymous">
      <!--main css file-->
      <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    </head>

<body>

    <!--main header container-->
    <div class="main_header">

      <div class="main_title_container">

        <p>GetWeatherToday.herokuapp.com</p> 

      </div>
    </div>

    <!--form group-->
    <div class="form_group">

      <form>

          <input type="text" autocomplete="off" placeholder="Insert a city" name="city_input" id="city_input">
          <input type="submit" value="GO!"  id="submit_btn">

      </form>
    </div>

     
  <!--weather_info group-->
  <div class="weather_info_container">

    <div class="weather_info_display">

        <div class="weather_info_display_city">
          <p id="city">  </p>
        </div>

        <div class="weather_info_display_icon">
            <i id="icon"></i>
         
           

        </div>

        <div class="weather_info_display_description">
          <p id="description">  </p>
        </div>

        <div class="weather_info_display_temp">
          <p id="t_max">  </p> <p id="t_min">  </p>
        </div>



      
     

    </div>
    
  </div>

  <!--footer-->
  <div id="footer">

    <p id="check">

    </p>
    
      
    
    
  </div>

 

  <script type="text/javascript">

  

  function remove_all_classes()
  {
    var classList = document.getElementById('icon').className.split(/\s+/);

      for (var i = 0; i < classList.length; i++) 
      {

        $("#icon").removeClass(classList[i]);
            
      }
  }
    
    function change_icon( condition_code )
    {
      //thunderstorm
      if( condition_code >= 200 && condition_code <= 232 )
      {
        remove_all_classes();
        $("#icon").addClass("fas fa-bolt");
        //<i class="fas fa-bolt"></i>


      }
      else if( condition_code >= 300 && condition_code <= 321 )
      {
        remove_all_classes();
        $("#icon").addClass("fas fa-cloud-rain");

      }
      else if( condition_code >= 500 && condition_code <= 531 )
      {
        remove_all_classes();
        $("#icon").addClass("fas fa-cloud-showers-heavy");

      }
      else if( condition_code >= 600 && condition_code <= 622 )
      {
        remove_all_classes();
        $("#icon").addClass("far fa-snowflake");

        //<i class="fas fa-wind"></i>

      }
      else if( condition_code >= 701 && condition_code <= 781 )
      {
        remove_all_classes();
        $("#icon").addClass("fas fa-wind");

      }
      else if( condition_code == 800 )
      {
        remove_all_classes();
        $("#icon").addClass("far fa-sun");


      }
      else if( condition_code >= 801 && condition_code <= 804 )
      {
        remove_all_classes();
        $("#icon").addClass("fas fa-cloud");

      }
      else
      {
        remove_all_classes();
      }
    }
      
  $(document).ready(function(){

      $('form').on('submit',function(){

          $.ajax({
            data : {
              city_input : $("#city_input").val()
            },
            type: 'POST',
            url: '/weather_today'

          }).done(function(data){

              if(data.response == '404')
              {
                remove_all_classes();
                $('#city').text(data.city);
                $('#description').text("");
                $('#t_min').text("");
                $('#t_max').text("");
                
              }
              else
              {
                  
                change_icon(data.condition_code);
                $('#city').text(data.city);
                $('#description').text(data.weather_description);
                $('#t_min').text(data.weather_temp_min);
                $('#t_max').text(data.weather_temp_max);
                
              }




            });
        event.preventDefault();
        });
      });

  
  
  
  
  </script>

  </body>
</html>